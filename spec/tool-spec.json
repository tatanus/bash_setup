{
  "blocked": false,
  "name": "bash_setup",
  "summary": "Bash dotfiles installer and manager that installs, updates, and uninstalls shell configuration files to user home directory with checksum-based change detection and backup management.",
  "language_mode": "bash",
  "languages": {
    "bash": {
      "version": "4+",
      "strict_mode": true,
      "enabled": true
    },
    "python": {
      "version": "3.12+",
      "typing": "recommended",
      "venv_required": false,
      "enabled": false
    }
  },
  "entrypoints": {
    "bash": [
      "install.sh"
    ],
    "python": []
  },
  "interfaces": {
    "bash_to_python": {
      "mode": "none",
      "ipc_request_schema_path": null,
      "ipc_response_schema_path": null,
      "python_invocation_contract": {
        "requires_request_json": false,
        "supports_cli_args": false
      },
      "enabled": false
    }
  },
  "io": {
    "inputs": [
      "CLI arguments: install|update|uninstall, --help, --version, --quiet, --force, --skip-tools",
      "Environment variables: HOME, BASH_VERSION, BASH_VERSINFO",
      "Source dotfiles from: dotfiles/ directory",
      "External dependency: common_core library at ~/.config/bash/lib/common_core/"
    ],
    "outputs": [
      "Dotfiles installed to: $HOME/.{bashrc,profile,bash_profile,tmux.conf,screenrc_v4,screenrc_v5,inputrc,vimrc,wgetrc,curlrc}",
      "Bash config files to: $HOME/.config/bash/*.sh",
      "Directories created: $HOME/DATA/LOGS, $HOME/.config/bash, $HOME/.config/bash/log",
      "Backups created: *.old timestamps for replaced files",
      "Exit codes: 0 (success), 1 (failure)",
      "Structured logging to stdout/stderr with timestamp and level prefixes"
    ]
  },
  "constraints": {
    "platforms": [
      "darwin",
      "linux"
    ],
    "dependencies": {
      "bash": [
        "common_core library at ~/.config/bash/lib/common_core/ (external, must be pre-installed)",
        "common_core provides: util.sh with file::copy, file::restore_old_backup, cmd::exists, and logging functions (info, warn, fail, pass, debug)"
      ],
      "python": []
    },
    "tools": [
      {
        "name": "bash",
        "version": ">= 4.0"
      },
      {
        "name": "sha256sum",
        "version": ">= 1.0"
      },
      {
        "name": "shasum",
        "version": ">= 1.0"
      },
      {
        "name": "jq",
        "version": ">= 1.6"
      }
    ]
  },
  "security": {
    "threat_model": "Trusted local user modifying their own home directory. External threat: malicious dotfiles in source directory could execute arbitrary code when sourced by shell.",
    "unsafe_operations": [
      "Overwrites existing dotfiles (with backup)",
      "Creates directories in user home",
      "Sources external common_core library (must trust that installation)",
      "Executes file::copy and file::restore_old_backup from common_core",
      "Recommends sourcing ~/.bashrc after install (user must manually execute)"
    ],
    "validation_rules": [
      "Verify BASH_VERSION >= 4.0 before execution",
      "Verify HOME environment variable is set and non-empty",
      "Verify common_core directory exists at ~/.config/bash/lib/common_core/",
      "Verify common_core util.sh exists and is sourceable",
      "Verify dotfiles/ source directory exists before operations",
      "Check file existence before attempting copy or restore",
      "Use sha256sum or shasum for checksum comparison (fallback: always different)",
      "All directory creation uses mkdir -p for idempotency",
      "Strict mode: set -uo pipefail, IFS=$'\\n\\t'"
    ]
  },
  "logging": {
    "format": "structured",
    "levels": [
      "FAIL",
      "PASS",
      "INFO",
      "WARN",
      "DEBUG"
    ]
  },
  "exit_codes": {
    "success": 0,
    "validation_error": 2,
    "runtime_error": 1
  },
  "tests": {
    "frameworks": {
      "bash": "bats",
      "python": "pytest"
    },
    "cases": [
      "Repository structure validation (dotfiles/, install.sh, VERSION, tools/ exist)",
      "install.sh is executable",
      "install.sh --help shows usage information",
      "install.sh --version shows VERSION file content",
      "install.sh rejects unknown options with exit 1",
      "Preflight checks detect missing common_core",
      "Preflight checks verify Bash 4+ requirement",
      "Dotfiles directory contains expected files (bashrc, vimrc, tmux.conf)",
      "Install command creates required directories",
      "Install command copies dotfiles with backups",
      "Update command only copies changed files (checksum comparison)",
      "Uninstall command restores from backups",
      "Recommended tools check runs during install (unless --skip-tools)",
      "files_differ function correctly compares checksums",
      "cmd_install handles missing source files gracefully (warns, continues)",
      "cmd_update reports count of updated files",
      "cmd_uninstall handles missing backups gracefully"
    ]
  },
  "docs": {
    "readme_sections": [
      "Title and description",
      "Features (install/update/uninstall modes, checksum-based updates, backup management)",
      "Requirements (Bash 4+, common_core library)",
      "Installation (how to install common_core first, then run install.sh)",
      "Usage (install.sh commands and options)",
      "Migration guide from SetupBash.sh to install.sh",
      "Dotfiles included (list of common and bash dotfiles)",
      "Directory structure created",
      "Testing (how to run bats tests)",
      "Makefile targets (fmt, lint, test, install, update, uninstall, version, release)",
      "Version management and release workflow",
      "Changelog reference"
    ]
  }
}
